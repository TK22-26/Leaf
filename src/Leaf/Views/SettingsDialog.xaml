<Window x:Class="Leaf.Views.SettingsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings"
        Height="480"
        Width="550"
        MinHeight="400"
        MinWidth="450"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        ResizeMode="CanResize">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   Text="Settings"
                   FontSize="20"
                   FontWeight="SemiBold"
                   Margin="0,0,0,20"/>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Azure DevOps Section -->
                <Border BorderThickness="1"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                        CornerRadius="4"
                        Padding="16"
                        Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Azure DevOps / GitHub Authentication"
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Margin="0,0,0,12"/>

                        <TextBlock Text="Organization"
                                   Margin="0,0,0,4"
                                   Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        <TextBox x:Name="OrganizationTextBox"
                                 Padding="8,6"
                                 Margin="0,0,0,4"/>
                        <TextBlock Text="Your Azure DevOps organization name (e.g., 'mycompany' from dev.azure.com/mycompany)"
                                   TextWrapping="Wrap"
                                   FontSize="11"
                                   Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                   Margin="0,0,0,16"/>

                        <TextBlock Text="Personal Access Token (PAT)"
                                   Margin="0,0,0,4"
                                   Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                        <TextBlock Text="Used for cloning and fetching from private Azure DevOps repositories. Needs 'Code (Read)' scope."
                                   TextWrapping="Wrap"
                                   FontSize="11"
                                   Foreground="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"
                                   Margin="0,0,0,8"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <PasswordBox x:Name="PatPasswordBox"
                                         Grid.Column="0"
                                         Padding="8,6"
                                         PasswordChanged="PatPasswordBox_PasswordChanged"/>
                            <Button x:Name="TogglePatVisibilityButton"
                                    Grid.Column="1"
                                    Content="Show"
                                    Width="60"
                                    Margin="8,0,0,0"
                                    Click="TogglePatVisibility_Click"/>
                        </Grid>

                        <TextBox x:Name="PatTextBox"
                                 Padding="8,6"
                                 Visibility="Collapsed"
                                 TextChanged="PatTextBox_TextChanged"
                                 Margin="0,8,0,0"/>

                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                            <Button x:Name="SavePatButton"
                                    Content="Save PAT"
                                    Padding="12,6"
                                    Click="SavePat_Click"/>
                            <Button x:Name="ClearPatButton"
                                    Content="Clear PAT"
                                    Padding="12,6"
                                    Margin="8,0,0,0"
                                    Click="ClearPat_Click"/>
                            <TextBlock x:Name="PatStatusText"
                                       VerticalAlignment="Center"
                                       Margin="12,0,0,0"
                                       FontSize="11"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Default Clone Path Section -->
                <Border BorderThickness="1"
                        BorderBrush="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"
                        CornerRadius="4"
                        Padding="16"
                        Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Default Clone Path"
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Margin="0,0,0,12"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="ClonePathTextBox"
                                     Grid.Column="0"
                                     Padding="8,6"/>
                            <Button Grid.Column="1"
                                    Content="Browse..."
                                    Padding="12,6"
                                    Margin="8,0,0,0"
                                    Click="BrowseClonePath_Click"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer buttons -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,20,0,0">
            <Button Content="Close"
                    Padding="16,8"
                    IsCancel="True"
                    Click="Close_Click"/>
        </StackPanel>
    </Grid>
</Window>
