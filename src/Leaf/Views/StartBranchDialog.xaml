<Window x:Class="Leaf.Views.StartBranchDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ic="clr-namespace:FluentIcons.Wpf;assembly=FluentIcons.Wpf"
        xmlns:models="clr-namespace:Leaf.Models"
        Title="Start Branch"
        Width="500"
        Height="400"
        MinWidth="400"
        MinHeight="350"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        Background="{DynamicResource ApplicationBackgroundBrush}"
        ResizeMode="CanResize">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Content -->
        <ScrollViewer Grid.Row="0" Padding="24,20" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Header -->
                <StackPanel Margin="0,0,0,20">
                    <TextBlock x:Name="HeaderText"
                               Text="Start New Branch"
                               FontSize="20"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                    <TextBlock x:Name="SubheaderText"
                               Text="Create a new GitFlow branch"
                               FontSize="13"
                               Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                               Margin="0,4,0,0"/>
                </StackPanel>

                <!-- Branch Type Selection -->
                <Border x:Name="BranchTypeSection"
                        Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Branch Type"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                   Margin="0,0,0,12"/>

                        <!-- Feature -->
                        <RadioButton x:Name="FeatureRadio" GroupName="BranchType"
                                     Margin="0,0,0,8" Checked="BranchType_Changed"
                                     Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="12" Height="12" CornerRadius="6"
                                        Background="#8250DF" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Feature" VerticalAlignment="Center"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Release -->
                        <RadioButton x:Name="ReleaseRadio" GroupName="BranchType"
                                     Margin="0,0,0,8" Checked="BranchType_Changed"
                                     Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="12" Height="12" CornerRadius="6"
                                        Background="#BF8700" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Release" VerticalAlignment="Center"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Hotfix -->
                        <RadioButton x:Name="HotfixRadio" GroupName="BranchType"
                                     Margin="0,0,0,8" Checked="BranchType_Changed"
                                     Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="12" Height="12" CornerRadius="6"
                                        Background="#CF222E" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Hotfix" VerticalAlignment="Center"/>
                            </StackPanel>
                        </RadioButton>

                        <!-- Support -->
                        <RadioButton x:Name="SupportRadio" GroupName="BranchType"
                                     Checked="BranchType_Changed"
                                     Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                            <StackPanel Orientation="Horizontal">
                                <Border Width="12" Height="12" CornerRadius="6"
                                        Background="#57606A" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                <TextBlock Text="Support" VerticalAlignment="Center"/>
                            </StackPanel>
                        </RadioButton>
                    </StackPanel>
                </Border>

                <!-- Branch Name/Version Input -->
                <Border Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock x:Name="NameLabel"
                                   Text="Feature Name"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                   Margin="0,0,0,4"/>
                        <TextBlock x:Name="NameHint"
                                   Text="Enter a descriptive name for this feature"
                                   FontSize="12"
                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                   Margin="0,0,0,8"/>

                        <TextBox x:Name="NameTextBox"
                                 Padding="10,8"
                                 TextChanged="NameTextBox_TextChanged"/>

                        <!-- Version suggestion buttons (for release/hotfix) -->
                        <StackPanel x:Name="VersionSuggestionPanel" Orientation="Horizontal"
                                    Margin="0,8,0,0" Visibility="Collapsed">
                            <TextBlock Text="Suggested:"
                                       FontSize="11"
                                       Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0"/>
                            <Button x:Name="SuggestedVersionButton"
                                    Padding="8,4"
                                    Click="SuggestedVersion_Click"
                                    Background="{DynamicResource ControlFillColorDefaultBrush}">
                                <TextBlock x:Name="SuggestedVersionText" FontSize="11"/>
                            </Button>
                        </StackPanel>

                        <!-- Preview -->
                        <Border Background="{DynamicResource ControlFillColorDefaultBrush}"
                                CornerRadius="4"
                                Padding="10,6"
                                Margin="0,12,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Branch name:"
                                           FontSize="11"
                                           Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                                           Margin="0,0,8,0"/>
                                <TextBlock x:Name="BranchPreviewText" Grid.Column="1"
                                           FontSize="11"
                                           FontFamily="Consolas"
                                           Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                           TextTrimming="CharacterEllipsis"/>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Base Branch (for support) -->
                <Border x:Name="BaseBranchSection"
                        Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="8"
                        Padding="16"
                        Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Base Tag or Commit"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                                   Margin="0,0,0,4"/>
                        <TextBlock Text="Enter a tag name or commit SHA to base the support branch on"
                                   FontSize="12"
                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                   Margin="0,0,0,8"/>

                        <TextBox x:Name="BaseRefTextBox" Padding="10,8"/>
                    </StackPanel>
                </Border>

                <!-- Info about base branch -->
                <Border x:Name="BaseBranchInfo"
                        Background="{DynamicResource ControlFillColorDefaultBrush}"
                        CornerRadius="6"
                        Padding="12"
                        Margin="0,0,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <ic:SymbolIcon Symbol="Info" FontSize="16"
                                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                       Margin="0,0,10,0" VerticalAlignment="Top"/>
                        <TextBlock x:Name="BaseBranchInfoText" Grid.Column="1"
                                   Text="This branch will be created from develop."
                                   FontSize="12" TextWrapping="Wrap"
                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                    </Grid>
                </Border>

                <!-- Validation Error -->
                <Border x:Name="ValidationErrorBorder"
                        Background="{DynamicResource SystemFillColorCriticalBackgroundBrush}"
                        BorderBrush="{DynamicResource SystemFillColorCriticalBrush}"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="12"
                        Margin="0,16,0,0"
                        Visibility="Collapsed">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <ic:SymbolIcon Symbol="ErrorCircle" FontSize="16"
                                       Foreground="{DynamicResource SystemFillColorCriticalBrush}"
                                       Margin="0,0,10,0" VerticalAlignment="Top"/>
                        <TextBlock x:Name="ValidationErrorText" Grid.Column="1"
                                   FontSize="12" TextWrapping="Wrap"
                                   Foreground="{DynamicResource TextFillColorPrimaryBrush}"/>
                    </Grid>
                </Border>

                <!-- Progress Section -->
                <StackPanel x:Name="ProgressSection" Visibility="Collapsed" Margin="0,16,0,0">
                    <ProgressBar x:Name="ProgressBar" IsIndeterminate="True" Height="4"/>
                    <TextBlock x:Name="ProgressText"
                               Text="Creating branch..."
                               FontSize="12"
                               Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                               Margin="0,8,0,0"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- Footer -->
        <Border Grid.Row="1"
                Background="{DynamicResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{DynamicResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,1,0,0"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Cancel"
                            Padding="20,10"
                            IsCancel="True"
                            Click="Cancel_Click"/>
                    <Button x:Name="StartButton"
                            Content="Start Branch"
                            Margin="12,0,0,0"
                            Padding="24,10"
                            Click="Start_Click"
                            IsEnabled="False"
                            Background="{DynamicResource AccentFillColorDefaultBrush}"
                            Foreground="White"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
