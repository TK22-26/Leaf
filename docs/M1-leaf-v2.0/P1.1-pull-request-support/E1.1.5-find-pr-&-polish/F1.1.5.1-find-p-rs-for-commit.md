---
title: Find PRs for Commit
status: planned
owner: TBD
start_date: asap
duration: 1d
story_points: 5
depends_on: []
follows: []
---

# F1.1.5.1: Find PRs for Commit

**Description:**
Implement FindPullRequestsForCommitAsync using GitHub API and add "Find Pull Request..." to commit context menu in graph view.

**Technical Approach:**

1. **FindPullRequestsForCommitAsync:**
   ```csharp
   // GET /repos/{owner}/{repo}/commits/{sha}/pulls
   // IMPORTANT: Requires preview header
   request.Headers.Accept.Add(
       new MediaTypeWithQualityHeaderValue("application/vnd.github.groot-preview+json"));
   ```

2. **Context Menu** (GitGraphView.xaml.cs CommitItem_ContextMenuOpening):
   ```csharp
   var findPrMenuItem = new MenuItem {
       Header = "Find Pull Request...",
       Command = viewModel.FindPullRequestForCommitCommand,
       CommandParameter = commit
   };
   menu.Items.Add(new Separator());
   menu.Items.Add(findPrMenuItem);
   ```

3. **MainViewModel.FindPullRequestForCommitCommand:**
   - 0 PRs: Show "No PRs found for {shortSha}"
   - 1 PR: Open PR panel, select PR directly
   - Multiple: Open PR panel, show filtered list
## Business Value

- **User Impact:** Click any commit to see associated PRs; answers "which PR introduced this change?"
- **Technical Value:** Uses groot-preview header for GitHub API; context menu integration follows existing patterns

## Inputs & Outputs

| Name | Type | Nullable | Description |
|:-----|:-----|:---------|:------------|
|  |  |  |  |

**Returns:** void - No return value

## Edge Cases & Boundary Conditions

| ID | Condition | Expected Behavior |
|:---|:----------|:------------------|
| EC-1 | No PRs found for commit | Show "No PRs found for {shortSha}" message |
| EC-2 | Single PR found | Open PR panel and select PR directly |
| EC-3 | Multiple PRs found | Show PR panel with filtered list |
| EC-4 | Missing groot-preview header | API returns 415 or empty - always include header |
| EC-5 | Squash-merged commit | Fall back to F1.1.5.2 squash detection |

## Acceptance Criteria

### Functional
- [ ] GET /repos/{owner}/{repo}/commits/{sha}/pulls endpoint called
- [ ] groot-preview Accept header always included
- [ ] "Find Pull Request..." menu item in commit context menu
- [ ] 0 results: shows "No PRs found" message
- [ ] 1 result: opens PR panel with PR selected
- [ ] Multiple results: opens PR panel with filtered list

### Quality
- [ ] Preview header prevents 415 errors
- [ ] No compiler warnings

## Dependencies

| Type | ID/Name | Notes |
|:-----|:--------|:------|
| Depends On | None | |
| Blocks | None | |

## User Stories

### US-1: Find PR from Commit

**User Story:**
> As a developer reviewing history, I want to find which PR introduced a commit so that I can understand the context.

**Acceptance Criteria:**
1. Given I right-click a commit in the graph, then I see "Find Pull Request..." menu item
2. Given I click the menu item and one PR exists, then the PR panel opens with that PR selected
3. Given I click the menu item and no PR exists, then I see "No PRs found for abc1234" message

## Amendments

| Date | Category | Description | Rationale |
|:-----|:---------|:------------|:----------|

## Proposed Improvements

<!-- Document opportunities for refactoring, scope adjustments, or better engineering practices here. Do not implement yet; just log them. When a proposed improvement affects work above this item's level, document it in the appropriate ancestor. -->

| ID | Description | Resolution |
|:---|:------------|:-----------|
