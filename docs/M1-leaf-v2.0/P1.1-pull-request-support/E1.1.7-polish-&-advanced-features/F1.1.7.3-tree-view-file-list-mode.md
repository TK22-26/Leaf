---
title: TreeView File List Mode
status: planned
owner: TBD
start_date: asap
duration: 0.5d
story_points: 3
depends_on: []
follows: []
---

# F1.1.7.3: TreeView File List Mode

**Description:**
Add directory-grouped TreeView mode for PR file list as alternative to flat list, with toggle button to switch modes.

**Technical Approach:**

1. **PullRequestFileNode.cs:**
   ```csharp
   public class PullRequestFileNode
   {
       public string Name { get; set; }
       public bool IsDirectory { get; set; }
       public string FullPath { get; set; }
       public PullRequestFileInfo? File { get; set; }  // Only for leaf nodes
       public ObservableCollection<PullRequestFileNode> Children { get; set; } = [];

       public string DisplayName => IsDirectory ? $"[DIR] {Name}" : $"{File?.StatusIndicator} {Name}";

       public static ObservableCollection<PullRequestFileNode> BuildTree(IEnumerable<PullRequestFileInfo> files)
       {
           // Sort by path, build tree structure
       }
   }
   ```

2. **ViewModel Properties:**
   - IsFileListFlat / IsFileListTree toggle
   - SelectedPrFilesTree computed from SelectedPrFiles

3. **TreeView in PullRequestPanel:**
   ```xml
   <TreeView ItemsSource="{Binding SelectedPrFilesTree}" Visibility="{Binding IsFileListTree, ...}">
       <TreeView.ItemTemplate>
           <HierarchicalDataTemplate ItemsSource="{Binding Children}">
               <TextBlock Text="{Binding DisplayName}" />
           </HierarchicalDataTemplate>
       </TreeView.ItemTemplate>
   </TreeView>
   ```
## Business Value

- **User Impact:** Directory-grouped view for large PRs; easier navigation of folder structure when reviewing many files
- **Technical Value:** HierarchicalDataTemplate for TreeView; computed tree from flat file list; toggle between views

## Inputs & Outputs

| Name | Type | Nullable | Description |
|:-----|:-----|:---------|:------------|
|  |  |  |  |

**Returns:** void - No return value

## Edge Cases & Boundary Conditions

| ID | Condition | Expected Behavior |
|:---|:----------|:------------------|
| EC-1 | Files in root (no directory) | Show directly under root, not in folder |
| EC-2 | Deeply nested paths | Build full tree hierarchy |
| EC-3 | Single file change | Still show tree view option (just simpler) |
| EC-4 | 100+ files | Tree view helps navigate; flat list may need virtualization |

## Acceptance Criteria

### Functional
- [ ] Toggle button switches between flat list and tree view
- [ ] Tree view groups files by directory
- [ ] Directory nodes show folder icon and name
- [ ] File nodes show status indicator (+/M/-) and name
- [ ] Clicking file node opens diff
- [ ] Tree computed from SelectedPrFiles collection

### Quality
- [ ] BuildTree algorithm handles all path formats
- [ ] No compiler warnings

## Dependencies

| Type | ID/Name | Notes |
|:-----|:--------|:------|
| Depends On | None | |
| Blocks | None | |

## User Stories

### US-1: Tree View for File List

**User Story:**
> As a developer reviewing a large PR, I want to see files grouped by directory so that I can navigate complex changes more easily.

**Acceptance Criteria:**
1. Given a PR with files in multiple directories, when I enable tree view, then files group under directory nodes
2. Given I click a directory node, when it expands, then child files and directories show
3. Given I click a file node, when diff loads, then I see the file diff

## Amendments

| Date | Category | Description | Rationale |
|:-----|:---------|:------------|:----------|

## Proposed Improvements

<!-- Document opportunities for refactoring, scope adjustments, or better engineering practices here. Do not implement yet; just log them. When a proposed improvement affects work above this item's level, document it in the appropriate ancestor. -->

| ID | Description | Resolution |
|:---|:------------|:-----------|
