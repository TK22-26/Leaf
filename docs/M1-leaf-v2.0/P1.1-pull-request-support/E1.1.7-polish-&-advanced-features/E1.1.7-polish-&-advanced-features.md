---
title: Polish & Advanced Features
status: planned
owner: TBD
start_date: asap
duration: 2.5d
story_points: 13
depends_on: []
follows: []
---

# E1.1.7: Polish & Advanced Features

**Current State:** Core PR features work but lack performance optimization and advanced UI features.

**Target State:** Optimized caching, polished UI with loading states and keyboard shortcuts, TreeView file mode, and full markdown rendering.

**Business Value:** Production-ready feature with excellent user experience; reduced API calls and faster response times.
## Critical Files

**Modify:**
- src/Leaf/Services/GitHubPullRequestService.cs - Add caching layer
- src/Leaf/Services/AzureDevOpsPullRequestService.cs - Add caching layer
- src/Leaf/Controls/PullRequestPanel.xaml - Add keyboard shortcuts, loading states, tree view toggle
- src/Leaf/Controls/PullRequestPanel.xaml.cs - Add keyboard handling
- src/Leaf/ViewModels/PullRequestViewModel.cs - Add cache invalidation, tree view properties

**Create:**
- src/Leaf/Models/PullRequestFileNode.cs - Tree node model for file list
- src/Leaf/Converters/MarkdownToFlowDocumentConverter.cs - Full markdown rendering (or use MdXaml)

## Features

| Feature | Description | Story Points | Status |
|:--------|:------------|:-------------|:-------|
| [F1.1.7.1](F1.1.7.1-caching-&-performance.md) | Caching & Performance | 3 |  | Draft |
| [F1.1.7.2](F1.1.7.2-ui-polish.md) | UI Polish | 3 |  | Draft |
| [F1.1.7.3](F1.1.7.3-tree-view-file-list-mode.md) | TreeView File List Mode | 3 |  | Draft |
| [F1.1.7.4](F1.1.7.4-full-markdown-renderer.md) | Full Markdown Renderer | 4 |  | Draft |

## Implementation Order

1. **F1.1.7.1 Caching & Performance** - Foundation for all other polish features
2. **F1.1.7.2 UI Polish** - Keyboard shortcuts, loading states, tooltips
3. **F1.1.7.3 TreeView File List** - Alternate file list display mode
4. **F1.1.7.4 Full Markdown Renderer** - Rich PR description/comment display

## Acceptance Criteria

### Functional
- [ ] PR list cache with 90-second TTL using ConcurrentDictionary
- [ ] Cache invalidated after create/merge/close/update operations
- [ ] Path normalization for consistent cache keys
- [ ] Keyboard shortcuts: Ctrl+R (refresh), Enter (open diff), Escape (close/deselect), Ctrl+O (browser)
- [ ] Loading spinner and error banner UI elements
- [ ] TreeView toggle for directory-grouped file list
- [ ] Full markdown rendering with MdXaml or Markdig.Wpf

### Quality
- [ ] Double-checked locking for thread-safe cache access
- [ ] All tests passing

## Dependencies

**Depends on:** None
**Blocks:** None

## Proposed Improvements

<!-- Document opportunities for refactoring, scope adjustments, or better engineering practices here. Do not implement yet; just log them. When a proposed improvement affects work above this item's level, document it in the appropriate ancestor. -->

| ID | Description | Resolution |
|:---|:------------|:-----------|
