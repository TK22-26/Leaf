---
title: Markdown Rendering
status: planned
owner: TBD
start_date: asap
duration: 0.33d
story_points: 2
depends_on: []
follows: []
---

# F1.1.2.4: Markdown Rendering

**Description:**
Add MarkdownToPlainTextConverter to strip markdown formatting from PR body and comments for readable plain-text display. This is a fallback until full markdown rendering (MdXaml/Markdig.Wpf) is added in E1.1.7.

**Technical Approach:**

```csharp
public class MarkdownToPlainTextConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is not string markdown || string.IsNullOrEmpty(markdown))
            return string.Empty;

        var result = markdown;

        // Remove code blocks (``` ... ```)
        result = Regex.Replace(result, @"```[\s\S]*?```", "[code block]");

        // Remove inline code (`...`)
        result = Regex.Replace(result, @"`([^`]+)`", "$1");

        // Remove headers (# ## ###)
        result = Regex.Replace(result, @"^#{1,6}\s*", "", RegexOptions.Multiline);

        // Remove bold/italic (**text**, *text*, __text__, _text_)
        result = Regex.Replace(result, @"\*\*([^*]+)\*\*", "$1");
        result = Regex.Replace(result, @"\*([^*]+)\*", "$1");
        result = Regex.Replace(result, @"__([^_]+)__", "$1");
        result = Regex.Replace(result, @"_([^_]+)_", "$1");

        // Convert links [text](url) to text (url)
        result = Regex.Replace(result, @"\[([^\]]+)\]\(([^)]+)\)", "$1 ($2)");

        // Remove images ![alt](url)
        result = Regex.Replace(result, @"!\[([^\]]*)\]\([^)]+\)", "[image: $1]");

        // Keep horizontal rules
        result = Regex.Replace(result, @"^[-*_]{3,}$", "---", RegexOptions.Multiline);

        return result.Trim();
    }

    public object ConvertBack(...) => throw new NotImplementedException();
}
```

Register in App.xaml resources, apply to PR body and comment bindings.
## Business Value

- **User Impact:** PR descriptions and comments display with readable formatting instead of raw markdown syntax
- **Technical Value:** Simple XAML converter pattern; graceful handling of malformed markdown; serves as fallback for full MdXaml renderer

## Inputs & Outputs

| Name | Type | Nullable | Description |
|:-----|:-----|:---------|:------------|
|  |  |  |  |

**Returns:** void - No return value

## Edge Cases & Boundary Conditions

| ID | Condition | Expected Behavior |
|:---|:----------|:------------------|
| EC-1 | Null or empty markdown | Return empty string |
| EC-2 | Nested formatting (**_bold italic_**) | Strip both markers, preserve text |
| EC-3 | Unclosed code fence | Display as-is (don't hang regex) |
| EC-4 | HTML tags in markdown | Preserve as-is (don't strip) |
| EC-5 | Very long code block | Replace with [code block] regardless of length |

### Functional
- [ ] Code blocks converted to [code block] placeholder
- [ ] Bold/italic markers removed, text preserved
- [ ] Links show as "text (url)"
- [ ] Headers display as plain text without # prefix
- [ ] Images show as [image: alt]
- [ ] PR body and comments use converter

### Quality
- [ ] Regex patterns handle common edge cases
- [ ] No exceptions on malformed markdown
- [ ] ConvertBack throws NotImplementedException (one-way binding)
## Dependencies

| Type | ID/Name | Notes |
|:-----|:--------|:------|
| Depends On | None | |
| Blocks | None | |

## User Stories

### US-1: Readable PR Descriptions

**User Story:**
> As a developer, I want PR descriptions to display without markdown syntax cluttering the text so that I can read content easily.

**Acceptance Criteria:**
1. Given a PR body with **bold** text, when displayed, then the text shows as "bold" without asterisks
2. Given a PR body with [link](url), when displayed, then it shows as "link (url)"
3. Given a PR body with a code fence, when displayed, then it shows as [code block]
4. Given a PR body with headers, when displayed, then the # symbols are removed

## Amendments

| Date | Category | Description | Rationale |
|:-----|:---------|:------------|:----------|

## Proposed Improvements

<!-- Document opportunities for refactoring, scope adjustments, or better engineering practices here. Do not implement yet; just log them. When a proposed improvement affects work above this item's level, document it in the appropriate ancestor. -->

| ID | Description | Resolution |
|:---|:------------|:-----------|
